# 統合テストチェックリスト

作成者: Worker3
作成日時: 2025-07-17 12:16
対象システム: 地域別クリニックランキングサイト + CSV管理画面
前提条件: Worker2のサーバーサイド実装完了後に実施

## 統合テスト概要

本チェックリストは、Worker1のフロントエンド実装とWorker2のバックエンド実装を
統合した際の動作確認項目を定義します。

## 前提条件確認

- [ ] Worker2のサーバーサイド実装完了
- [ ] APIエンドポイントのドキュメント受領
- [ ] テスト環境のセットアップ完了
- [ ] テストデータの準備完了

## 1. 基本接続テスト

### 1.1 サーバー起動確認
- [ ] バックエンドサーバーが正常に起動
- [ ] 指定ポートでリスニング確認
- [ ] エラーログに異常なし

### 1.2 エンドポイント疎通確認
- [ ] /admin/api/health - ヘルスチェック
- [ ] /admin/api/upload - ファイルアップロード
- [ ] /admin/api/validate - データ検証
- [ ] /admin/api/save - データ保存
- [ ] /admin/api/backup - バックアップ管理

## 2. ファイルアップロード統合テスト

### 2.1 単一ファイルアップロード
| CSVタイプ | テスト内容 | 結果 | 備考 |
|-----------|------------|------|------|
| region | 正常ファイルアップロード | - | |
| items | 正常ファイルアップロード | - | |
| ranking | 正常ファイルアップロード | - | |
| stores | 正常ファイルアップロード | - | |
| store_view | 正常ファイルアップロード | - | |

### 2.2 複数ファイル同時アップロード
- [ ] 2ファイル同時アップロード
- [ ] 3ファイル同時アップロード
- [ ] 5ファイル同時アップロード（全種類）

### 2.3 エラーケーステスト
- [ ] 大容量ファイル（10MB超）のエラーハンドリング
- [ ] 不正なファイル形式のエラーハンドリング
- [ ] 文字化けファイルのエラーハンドリング
- [ ] 空ファイルのエラーハンドリング
- [ ] ネットワークエラー時の再試行

## 3. データ検証統合テスト

### 3.1 正常系検証
- [ ] 全ファイル揃っている場合の検証
- [ ] データ整合性チェック（地域IDの一致）
- [ ] データ整合性チェック（クリニックIDの一致）
- [ ] データ整合性チェック（店舗IDの一致）

### 3.2 異常系検証
- [ ] 必須ファイル不足時の検証
- [ ] データ不整合時の警告表示
- [ ] 循環参照データの検出
- [ ] 重複データの検出

## 4. データ保存・永続化テスト

### 4.1 保存機能テスト
- [ ] 全データの保存成功
- [ ] 部分データの保存（一部ファイルのみ）
- [ ] 保存後のデータ読み込み確認
- [ ] 既存データの上書き保存

### 4.2 トランザクション管理
- [ ] 保存途中エラー時のロールバック
- [ ] 同時保存の排他制御
- [ ] データ整合性の維持

## 5. バックアップ・復元統合テスト

### 5.1 バックアップ作成
- [ ] サーバーサイドバックアップ作成
- [ ] バックアップファイルの保存確認
- [ ] バックアップメタデータの記録

### 5.2 バックアップ復元
- [ ] 完全復元テスト
- [ ] 部分復元テスト
- [ ] 異なるバージョンからの復元

### 5.3 バックアップ管理
- [ ] バックアップリスト取得
- [ ] 古いバックアップの自動削除
- [ ] バックアップファイルのダウンロード

## 6. パフォーマンス統合テスト

### 6.1 レスポンス時間測定
| 操作 | 目標時間 | 実測時間 | 結果 |
|------|----------|----------|------|
| 1MBファイルアップロード | 3秒以内 | - | - |
| 5MBファイルアップロード | 10秒以内 | - | - |
| データ検証（1000件） | 2秒以内 | - | - |
| データ保存 | 5秒以内 | - | - |
| バックアップ作成 | 10秒以内 | - | - |

### 6.2 同時処理テスト
- [ ] 5ユーザー同時アップロード
- [ ] 10ユーザー同時アクセス
- [ ] 高負荷時のエラー率測定

## 7. セキュリティ統合テスト

### 7.1 認証・認可
- [ ] 管理画面アクセス制御
- [ ] APIトークン検証
- [ ] セッション管理

### 7.2 データ保護
- [ ] SQLインジェクション対策確認
- [ ] XSS対策確認（サーバーサイド）
- [ ] CSRFトークン検証
- [ ] ファイルアップロード制限

## 8. エラーハンドリング統合テスト

### 8.1 クライアント側エラー表示
- [ ] サーバーエラー時のメッセージ表示
- [ ] タイムアウト時の処理
- [ ] ネットワークエラー時の処理

### 8.2 サーバー側エラーログ
- [ ] エラーログの適切な記録
- [ ] スタックトレースの記録
- [ ] エラー通知機能

## 9. フロントエンド反映テスト

### 9.1 データ更新反映
- [ ] CSVアップロード後のデータ反映
- [ ] リアルタイム更新確認
- [ ] キャッシュクリア機能

### 9.2 UI/UX統合確認
- [ ] プログレスバーの正確性
- [ ] エラーメッセージの適切性
- [ ] 成功メッセージの表示

## 10. 運用機能テスト

### 10.1 ログ機能
- [ ] アクセスログ記録
- [ ] 操作ログ記録
- [ ] エラーログ記録

### 10.2 監視機能
- [ ] ヘルスチェックエンドポイント
- [ ] メトリクス収集
- [ ] アラート機能

## 実施手順

### Phase 1: 環境準備（13:30-13:45）
1. Worker2の実装確認
2. サーバー起動
3. 接続確認
4. テストデータ準備

### Phase 2: 基本機能テスト（13:45-14:00）
1. 単一ファイルアップロード
2. データ検証
3. 保存機能
4. エラーケース

### Phase 3: 高度な機能テスト（14:00-14:15）
1. 複数ファイル処理
2. バックアップ機能
3. パフォーマンス測定
4. セキュリティ確認

### Phase 4: 最終確認（14:15-14:30）
1. 全機能の統合動作確認
2. ドキュメント作成
3. 問題点の整理
4. 改善提案のまとめ

## 合格基準

- 全ての必須テスト項目がPASS
- パフォーマンス基準を満たす
- セキュリティ要件を満たす
- エラー率が1%未満

## リスクと対策

| リスク | 影響度 | 対策 |
|--------|--------|------|
| API仕様の不一致 | 高 | 事前の仕様確認 |
| パフォーマンス問題 | 中 | 段階的な負荷テスト |
| データ不整合 | 高 | トランザクション管理 |
| セキュリティ脆弱性 | 高 | 多層防御の実装 |

## 備考

- テスト実施時は必ずバックアップを取得
- 問題発生時は即座にWorker2と連携
- 全てのテスト結果を記録
- 改善提案は別途文書化